!function(t,i){"function"==typeof define&&define.amd?define([],i):"object"==typeof module&&module.exports?module.exports=i():t.erudaFps=i()}(this,(function(){var t=window.innerWidth;return function(i){var e=t,s=12,n=40,a=t-24,l=142,h=i.util,c=i.Settings,o=Math.round,r=i.Tool,_=r.extend({name:"fps",init:function(t,i){this.callSuper(r,"init",arguments),this._style=h.evalCss([".eruda-fps {padding: 10px !important;}","canvas {width: 100%; border: 1px solid var(--border);}"].join(".eruda-fps ")),this._container=i,this._isRunning=!1,this._beginTime=h.now(),this._prevTime=this._beginTime,this._frames=0,this._min=1/0,this._max=0,this._alwaysActivated=!0,this._appendTpl(),this._initCanvas(),this._initCfg()},show:function(){this._start(),this.callSuper(r,"show",arguments)},hide:function(){this._alwaysActivated||this._stop(),this.callSuper(r,"hide",arguments)},destroy:function(){this._stop(),h.evalCss.remove(this._style),this.callSuper(r,"destroy",arguments),this._rmCfg()},_rmCfg:function(){var t=this.config,i=this._container.get("settings");i&&i.remove(t,"alwaysActivated").remove("Fps")},_start:function(){if(!this._isRunning){var t=this;this._isRunning=!0,function i(){t._isRunning&&(t._update(),requestAnimationFrame(i))}()}},_stop:function(){this._isRunning=!1,this._beginTime=h.now(),this._prevTime=this._beginTime,this._frames=0},_appendTpl:function(){this._$el.html("<canvas></canvas>"),this._canvas=this._$el.find("canvas").get(0),this._ctx=this._canvas.getContext("2d")},_initCanvas:function(){var t=this._canvas,i=this._ctx,c=h.evalCss.getCurTheme(),o=c.background,r=c.accent;t.width=e,t.height=192,i.font="bold 18px Helvetica,Arial,sans-serif",i.textBaseline="top",i.fillStyle=o,i.fillRect(0,0,e,192),i.fillStyle=r,i.fillText("FPS",12,8),i.fillRect(s,n,a,l),i.fillStyle=o,i.globalAlpha=.9,i.fillRect(s,n,a,l)},_initCfg:function(){var t=this._container,i=this.config=c.createCfg("fps",{alwaysActivated:!0});i.get("alwaysActivated")||(this._alwaysActivated=!1);var e=this;i.on("change",(function(t,i){"alwaysActivated"!==t||(e._alwaysActivated=i)})),t.get("settings").text("Fps").switch(i,"alwaysActivated","Always Activated").separator()},_update:function(){this._frames++;var t=this._prevTime,i=h.now();i>t+1e3&&(this._draw(1e3*this._frames/(i-t),100),this._prevTime=i,this._frames=0),this._beginTime=i},_draw:function(t,i){this._min=Math.min(this._min,t),this._max=Math.max(this._max,t);var c=h.evalCss.getCurTheme(),r=c.background,_=c.accent,f=this._min,d=this._max,u=this._canvas,v=this._ctx;v.fillStyle=r,v.globalAlpha=1,v.fillRect(0,0,e,n),v.fillStyle=_,v.fillText(o(t)+"FPS ("+o(f)+"-"+o(d)+")",12,8),v.drawImage(u,14,n,a-2,l,s,n,a-2,l),v.fillRect(s+a-2,n,2,l),v.fillStyle=r,v.globalAlpha=.9,v.fillRect(s+a-2,n,2,o((1-t/i)*l))}});return new _}}));
//# sourceMappingURL=eruda-fps.js.map
